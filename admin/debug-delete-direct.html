<!DOCTYPE html>
<html>
<head>
    <title>Direct Delete Debug</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        pre { background: #f5f5f5; padding: 10px; overflow: auto; }
        button { padding: 10px; margin: 5px; cursor: pointer; }
    </style>
</head>
<body>
    <h1>Direct Delete Debug</h1>
    <p>This tool tests delete functionality with different approaches</p>
    
    <div>
        <h2>Test Configuration</h2>
        <label>Product ID: <input type="number" id="product-id" value="6"></label>
    </div>
    
    <div>
        <h2>Test Methods</h2>
        <button onclick="testDirectString()">Test Direct String</button>
        <button onclick="testFormData()">Test FormData</button>
        <button onclick="testURLSearchParams()">Test URLSearchParams</button>
        <button onclick="testJSONBody()">Test JSON Body</button>
    </div>
    
    <div id="result"></div>
    
    <script>
        const resultDiv = document.getElementById('result');
        
        // Test with direct string approach
        async function testDirectString() {
            const productId = document.getElementById('product-id').value;
            resultDiv.innerHTML = '<h3>Testing Direct String Approach...</h3>';
            
            try {
                // Direct string approach
                const body = `action=delete&id=${encodeURIComponent(productId)}`;
                
                const response = await fetch('../api/products.php', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded'
                    },
                    body: body
                });
                
                displayResult('Direct String', body, response);
            } catch (error) {
                resultDiv.innerHTML += `<h3>Error: ${error.message}</h3>`;
            }
        }
        
        // Test with FormData approach
        async function testFormData() {
            const productId = document.getElementById('product-id').value;
            resultDiv.innerHTML = '<h3>Testing FormData Approach...</h3>';
            
            try {
                // FormData approach
                const formData = new FormData();
                formData.append('action', 'delete');
                formData.append('id', productId);
                
                // Convert to URLSearchParams for x-www-form-urlencoded
                const urlEncodedData = new URLSearchParams(formData).toString();
                
                const response = await fetch('../api/products.php', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded'
                    },
                    body: urlEncodedData
                });
                
                displayResult('FormData', urlEncodedData, response);
            } catch (error) {
                resultDiv.innerHTML += `<h3>Error: ${error.message}</h3>`;
            }
        }
        
        // Test with URLSearchParams approach
        async function testURLSearchParams() {
            const productId = document.getElementById('product-id').value;
            resultDiv.innerHTML = '<h3>Testing URLSearchParams Approach...</h3>';
            
            try {
                // URLSearchParams approach
                const params = new URLSearchParams();
                params.append('action', 'delete');
                params.append('id', productId);
                
                const response = await fetch('../api/products.php', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded'
                    },
                    body: params.toString()
                });
                
                displayResult('URLSearchParams', params.toString(), response);
            } catch (error) {
                resultDiv.innerHTML += `<h3>Error: ${error.message}</h3>`;
            }
        }
        
        // Test with JSON body approach
        async function testJSONBody() {
            const productId = document.getElementById('product-id').value;
            resultDiv.innerHTML = '<h3>Testing JSON Body Approach...</h3>';
            
            try {
                // JSON body approach
                const data = {
                    action: 'delete',
                    id: productId
                };
                
                const response = await fetch('../api/products.php', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(data)
                });
                
                displayResult('JSON Body', JSON.stringify(data), response);
            } catch (error) {
                resultDiv.innerHTML += `<h3>Error: ${error.message}</h3>`;
            }
        }
        
        // Helper function to display results
        async function displayResult(method, body, response) {
            const text = await response.text();
            let data;
            let dataDisplay = '';
            
            try {
                data = JSON.parse(text);
                dataDisplay = `<pre>${JSON.stringify(data, null, 2)}</pre>`;
            } catch (error) {
                dataDisplay = `<p>Error parsing JSON: ${error.message}</p><pre>${text}</pre>`;
            }
            
            resultDiv.innerHTML += `
                <h3>${method} Results:</h3>
                <p><strong>Request Body:</strong></p>
                <pre>${body}</pre>
                <p><strong>Response Status:</strong> ${response.status}</p>
                <p><strong>Response Data:</strong></p>
                ${dataDisplay}
                <hr>
            `;
        }
    </script>
</body>
</html>